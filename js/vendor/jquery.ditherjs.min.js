/*! ditherjs 2016-01-01 */
"use strict";var DitherJS=function(a){function b(a,b){return Math.sqrt(Math.pow(a[0]-b[0],2)+Math.pow(a[1]-b[1],2)+Math.pow(a[2]-b[2],2))}function c(a,c){var d=function(a,b,c,e){if(2==c.length)return a(b,e)<=a(b,c[1])?e:c[1];var f=c.slice(1);return e=a(b,e)<=a(b,c[1])?e:c[1],d(a,b,f,e)},e=d(b,a,c,c[0]);return e}function d(a,b,d,e,f,g){for(var h=b.createImageData(a),i=new Uint8ClampedArray(a.data),j=3,k=new Array([1,9,3,11],[13,5,15,7],[4,12,2,10],[16,8,14,6]),l=0;f>l;l+=e)for(var m=0;g>m;m+=e){var n=4*m+4*l*g,o=n,p=n+1,q=n+2;i[o]+=k[m%4][l%4]*j,i[p]+=k[m%4][l%4]*j,i[q]+=k[m%4][l%4]*j;for(var r=new Array(i[o],i[p],i[q]),s=c(r,d),t=s[0],u=s[1],v=s[2],w=0;e>w;w++)for(var x=0;e>x;x++){var y=n+4*w+4*g*x;i[y]=t,i[y+1]=u,i[y+2]=v}}return h.data.set(i),h}function e(a,b,d,e,f,g){for(var h=b.createImageData(a),i=new Uint8ClampedArray(a.data),j=new Uint8ClampedArray(a.data),k=1/8,l=0;f>l;l+=e)for(var m=0;g>m;m+=e){var n=4*m+4*l*g,o=function(a,b){return 4*a+4*b*g},p=n,q=n+1,r=n+2,s=new Array(i[p],i[q],i[r]),t=c(s,d),u=[];u[p]=i[p]-t[0],u[q]=i[q]-t[1],u[r]=i[r]-t[2],i[o(m+e,l)+0]+=k*u[p],i[o(m-e,l+e)+0]+=k*u[p],i[o(m,l+e)+0]+=k*u[p],i[o(m+e,l+e)+0]+=k*u[p],i[o(m+2*e,l)+0]+=k*u[p],i[o(m,l+2*e)+0]+=k*u[p],i[o(m+e,l)+1]+=k*u[p],i[o(m-e,l+e)+1]+=k*u[p],i[o(m,l+e)+1]+=k*u[p],i[o(m+e,l+e)+1]+=k*u[p],i[o(m+2*e,l)+1]+=k*u[p],i[o(m,l+2*e)+1]+=k*u[p],i[o(m+e,l)+2]+=k*u[p],i[o(m-e,l+e)+2]+=k*u[p],i[o(m,l+e)+2]+=k*u[p],i[o(m+e,l+e)+2]+=k*u[p],i[o(m+2*e,l)+2]+=k*u[p],i[o(m,l+2*e)+2]+=k*u[p];for(var v=t[0],w=t[1],x=t[2],y=0;e>y;y++)for(var z=0;e>z;z++){var A=n+4*y+4*g*z;j[A]=v,j[A+1]=w,j[A+2]=x}}return h.data.set(j),h}function f(a,b,d,e,f,g){for(var h=b.createImageData(a),i=new Uint8ClampedArray(a.data),j=new Uint8ClampedArray(a.data),k=1/16,l=(new Array([1,9,3,11],[13,5,15,7],[4,12,2,10],[16,8,14,6]),0);f>l;l+=e)for(var m=0;g>m;m+=e){var n=4*m+4*l*g,o=function(a,b){return 4*a+4*b*g},p=n,q=n+1,r=n+2,s=new Array(i[p],i[q],i[r]),t=c(s,d),u=[];u[p]=i[p]-t[0],u[q]=i[q]-t[1],u[r]=i[r]-t[2],i[o(m+e,l)]=i[o(m+e,l)]+7*k*u[p],i[o(m-e,l+1)]=i[o(m-1,l+e)]+3*k*u[p],i[o(m,l+e)]=i[o(m,l+e)]+5*k*u[p],i[o(m+e,l+e)]=i[o(m+1,l+e)]+1*k*u[p],i[o(m+e,l)+1]=i[o(m+e,l)+1]+7*k*u[q],i[o(m-e,l+e)+1]=i[o(m-e,l+e)+1]+3*k*u[q],i[o(m,l+e)+1]=i[o(m,l+e)+1]+5*k*u[q],i[o(m+e,l+e)+1]=i[o(m+e,l+e)+1]+1*k*u[q],i[o(m+e,l)+2]=i[o(m+e,l)+2]+7*k*u[r],i[o(m-e,l+e)+2]=i[o(m-e,l+e)+2]+3*k*u[r],i[o(m,l+e)+2]=i[o(m,l+e)+2]+5*k*u[r],i[o(m+e,l+e)+2]=i[o(m+e,l+e)+2]+1*k*u[r];for(var v=t[0],w=t[1],x=t[2],y=0;e>y;y++)for(var z=0;e>z;z++){var A=n+4*y+4*g*z;j[A]=v,j[A+1]=w,j[A+2]=x}}return h.data.set(j),h}var g=function(a,b){var c=this;c.opt=b||{},c.opt.step=c.opt.step||1,c.opt.className=c.opt.className||"dither",c.opt.algorithm=c.opt.algorithm||"ordered",c.opt.palette=c.opt.palette||[[0,0,0],[255,0,255],[0,255,255],[255,255,255]],this._refreshDither=function(a){a.src=a.src+"?"+Math.random(),a.onload=function(){var b=Date.now();c._dither(a),console.log("Microtime: ",Date.now()-b)}},this._dither=function(a){var b=a.clientHeight,g=a.clientWidth;this.getContext=function(a){var b=document.createElement("canvas");b.height=a.clientHeight,b.width=a.clientWidth,a.parentNode.replaceChild(b,a),b.className=a.className,b.className=b.className.replace(c.opt.className," ");var d=b.getContext("2d");return d.imageSmoothingEnabled=!1,d};var h=this.getContext(a);h.drawImage(a,0,0,g,b);var i=h.getImageData(0,0,g,b);if("errorDiffusion"==c.opt.algorithm)var j=f(i,h,c.opt.palette,c.opt.step,b,g);else if("ordered"==c.opt.algorithm)var j=d(i,h,c.opt.palette,c.opt.step,b,g);else{if("atkinson"!=c.opt.algorithm)throw new Error("Not a valid algorithm");var j=e(i,h,c.opt.palette,c.opt.step,b,g)}h.putImageData(j,0,0)};try{for(var g=document.querySelectorAll(a),h=0;h<g.length;h++)this._refreshDither(g[h])}catch(i){}};return g.orderedDither=d,g.atkinsonDither=e,g.errorDiffusionDither=f,g}(window);"function"==typeof define&&define.amd&&define("ditherjs",function(){return DitherJS}),"object"==typeof module&&module.exports&&(module.exports=DitherJS),function(a){a.fn.ditherJS=function(a){return new DitherJS(this.selector,a),this}}(jQuery);